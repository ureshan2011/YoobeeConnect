<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Yoobee Connect · Admin Insights</title>
  <style>
    :root {
      --bg: #020617;
      --panel: rgba(15, 23, 42, 0.78);
      --card: rgba(15, 23, 42, 0.9);
      --border: rgba(148, 163, 184, 0.25);
      --text: #f8fafc;
      --muted: #94a3b8;
      --accent: #38bdf8;
      --accent-soft: rgba(56, 189, 248, 0.18);
      --green: #22c55e;
      --purple: #a855f7;
      --orange: #f97316;
      --shadow: 0 30px 60px rgba(2, 6, 23, 0.55);
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: "Inter", system-ui, -apple-system, Segoe UI, sans-serif;
      background: radial-gradient(circle at 15% 20%, rgba(56,189,248,0.25), transparent 40%),
                  radial-gradient(circle at 85% 10%, rgba(168,85,247,0.22), transparent 45%),
                  linear-gradient(180deg, #020617 0%, #0f172a 55%, #111827 100%);
      color: var(--text);
      min-height: 100vh;
      padding: 48px 24px 64px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .shell {
      width: 100%;
      max-width: 1180px;
      display: grid;
      gap: 24px;
    }
    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 12px;
      padding: 28px 32px;
      border-radius: 28px;
      background: var(--panel);
      border: 1px solid var(--border);
      backdrop-filter: blur(18px);
      box-shadow: var(--shadow);
    }
    header h1 {
      margin: 0;
      font-size: 30px;
      font-weight: 700;
      letter-spacing: 0.2px;
    }
    header p {
      margin: 4px 0 0;
      color: var(--muted);
      font-size: 15px;
    }
    .actions {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
    }
    button {
      font: inherit;
      border: 0;
      border-radius: 14px;
      padding: 10px 18px;
      cursor: pointer;
      transition: transform 0.16s ease, box-shadow 0.24s ease;
    }
    .btn-outline {
      background: transparent;
      border: 1px solid var(--border);
      color: var(--text);
    }
    .btn-primary {
      background: linear-gradient(135deg, #06b6d4, #38bdf8);
      color: #082f49;
      font-weight: 600;
    }
    button:hover {
      transform: translateY(-1px);
      box-shadow: 0 12px 28px rgba(2, 132, 199, 0.25);
    }
    .grid {
      display: grid;
      gap: 24px;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
    }
    .card {
      padding: 24px 26px;
      background: var(--card);
      border: 1px solid rgba(148,163,184,0.22);
      border-radius: 26px;
      box-shadow: 0 22px 45px rgba(15, 23, 42, 0.4);
      backdrop-filter: blur(12px);
      display: flex;
      flex-direction: column;
      gap: 18px;
    }
    .table-wrapper {
      width: 100%;
      overflow-x: auto;
      padding-bottom: 4px;
    }
    .card h2 {
      margin: 0;
      font-size: 20px;
      letter-spacing: 0.4px;
    }
    .muted { color: var(--muted); }
    .stat-group {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
      gap: 16px;
    }
    .stat {
      background: rgba(148, 163, 184, 0.08);
      border-radius: 18px;
      padding: 18px;
      border: 1px solid rgba(148, 163, 184, 0.12);
    }
    .stat .value {
      font-size: 26px;
      font-weight: 700;
    }
    .badge {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 6px 12px;
      border-radius: 999px;
      background: rgba(56,189,248,0.18);
      color: #bae6fd;
      font-size: 13px;
      font-weight: 600;
      letter-spacing: 0.3px;
      text-transform: uppercase;
    }
    .chip-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }
    .chip {
      padding: 6px 12px;
      border-radius: 999px;
      background: rgba(56, 189, 248, 0.12);
      border: 1px solid rgba(56, 189, 248, 0.25);
      font-size: 13px;
      color: #e0f2fe;
    }
    .bar-list {
      display: grid;
      gap: 12px;
    }
    .bar {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }
    .bar-track {
      height: 12px;
      border-radius: 999px;
      background: rgba(148, 163, 184, 0.15);
      overflow: hidden;
    }
    .bar-fill {
      height: 100%;
      border-radius: 999px;
      background: linear-gradient(90deg, rgba(56,189,248,0.9), rgba(6,182,212,0.9));
    }
    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 14px;
    }
    .matches td {
      vertical-align: top;
    }
    .match-meta {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }
    .person {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }
    .person-name {
      font-weight: 600;
    }
    .person-meta {
      font-size: 12px;
      letter-spacing: 0.4px;
      text-transform: uppercase;
      color: rgba(148, 163, 184, 0.85);
    }
    th, td {
      padding: 10px 12px;
      text-align: left;
      border-bottom: 1px solid rgba(148, 163, 184, 0.16);
    }
    th { color: var(--muted); font-weight: 600; }
    .lock-screen {
      position: fixed;
      inset: 0;
      background: rgba(2, 6, 23, 0.95);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 100;
    }
    .lock-card {
      width: min(90vw, 420px);
      padding: 32px 28px 36px;
      border-radius: 28px;
      background: rgba(15, 23, 42, 0.85);
      border: 1px solid rgba(148, 163, 184, 0.25);
      box-shadow: var(--shadow);
      display: grid;
      gap: 18px;
      text-align: center;
    }
    .lock-card h2 {
      margin: 0;
      font-size: 24px;
    }
    .lock-card input {
      font: inherit;
      padding: 12px 14px;
      border-radius: 14px;
      border: 1px solid rgba(148, 163, 184, 0.4);
      background: rgba(15, 23, 42, 0.8);
      color: var(--text);
    }
    .lock-card input:focus {
      outline: none;
      border-color: rgba(56, 189, 248, 0.8);
      box-shadow: 0 0 0 4px rgba(56, 189, 248, 0.18);
    }
    .error {
      color: #fca5a5;
      min-height: 20px;
      font-size: 14px;
    }
    @media (max-width: 820px) {
      header {
        flex-direction: column;
        align-items: flex-start;
      }
      .actions { width: 100%; }
      .actions button { flex: 1; }
    }
  </style>
</head>
<body>
  <div class="lock-screen" id="lock-screen">
    <div class="lock-card">
      <h2>Administrator Access</h2>
      <p class="muted">Enter the passcode to review matchmaking analytics.</p>
      <input type="password" id="admin-pass" placeholder="Password" autocomplete="off" />
      <button class="btn-primary" id="unlock-btn">Unlock dashboard</button>
      <div class="error" id="lock-error"></div>
    </div>
  </div>

  <main class="shell" id="dashboard" style="display:none">
    <header>
      <div>
        <h1>Yoobee Connect · Admin Insights</h1>
        <p>Live overview of matches, mutual interests, and campus distribution.</p>
      </div>
      <div class="actions">
        <button class="btn-outline" id="refresh-btn">Refresh Data</button>
        <button class="btn-primary" id="lock-btn">Lock</button>
      </div>
    </header>

    <section class="grid">
      <article class="card">
        <div class="badge">Snapshot</div>
        <div class="stat-group" id="stat-cards"></div>
      </article>

      <article class="card">
        <div class="badge">Top shared interests</div>
        <div class="bar-list" id="interest-bars"></div>
      </article>

      <article class="card">
        <div class="badge">Countries represented</div>
        <div class="bar-list" id="country-bars"></div>
      </article>

      <article class="card">
        <div class="badge">Hobby participation</div>
        <div class="bar-list" id="hobby-bars"></div>
      </article>

      <article class="card">
        <div class="badge">All matched pairs</div>
        <div class="table-wrapper">
          <table class="matches">
            <thead>
              <tr>
                <th>Match ID</th>
                <th>Participant A</th>
                <th>Participant B</th>
                <th>Shared interests</th>
              </tr>
            </thead>
            <tbody id="matches-table"></tbody>
          </table>
        </div>
      </article>

      <article class="card">
        <div class="badge">Mutual interest matrix</div>
        <div class="muted" style="font-size:13px">Showing the most frequent shared topics inside matched pairs.</div>
        <table>
          <thead>
            <tr><th>Interest</th><th>Pairs</th><th>Participants involved</th></tr>
          </thead>
          <tbody id="interest-table"></tbody>
        </table>
      </article>
    </section>
  </main>

  <script>
    const PASSWORD = "14309";

    const dataset = {
      generatedAt: new Date().toISOString(),
      participants: [
        {
          name: "Amelia Chen",
          campus: "Auckland",
          country: "New Zealand",
          interests: ["UI Design", "Photography", "Hiking"],
          hobbies: ["Trail running", "Indie films", "Urban sketching"]
        },
        {
          name: "Noah Patel",
          campus: "Wellington",
          country: "India",
          interests: ["UI Design", "Hiking", "Film"],
          hobbies: ["Rock climbing", "Fusion cooking", "Street photography"]
        },
        {
          name: "Mia Clarke",
          campus: "Christchurch",
          country: "United Kingdom",
          interests: ["Game Design", "Esports", "3D Art"],
          hobbies: ["Esports shoutcasting", "Cosplay", "Miniature painting"]
        },
        {
          name: "Lucas Thompson",
          campus: "Auckland",
          country: "New Zealand",
          interests: ["3D Art", "Illustration", "Board Games"],
          hobbies: ["Board game design", "Cycling", "Coffee roasting"]
        },
        {
          name: "Isla Martin",
          campus: "Tauranga",
          country: "Australia",
          interests: ["Animation", "Photography", "Travel"],
          hobbies: ["Landscape photography", "Travel vlogging", "Freediving"]
        },
        {
          name: "Oliver Jackson",
          campus: "Dunedin",
          country: "New Zealand",
          interests: ["Animation", "Travel", "Cycling"],
          hobbies: ["Gravel biking", "Culinary tours", "Podcasting"]
        },
        {
          name: "Harper Singh",
          campus: "Wellington",
          country: "Canada",
          interests: ["Film", "Storytelling", "Coffee"],
          hobbies: ["Screenwriting", "Latte art", "Calligraphy"]
        },
        {
          name: "Leo Walker",
          campus: "Hamilton",
          country: "United States",
          interests: ["Storytelling", "Hiking", "Cooking"],
          hobbies: ["Plant-based cooking", "Backpacking", "Digital illustration"]
        }
      ],
      matches: [
        {
          id: "YC-231",
          pair: ["Amelia Chen", "Noah Patel"],
          mutual: ["UI Design", "Hiking"],
          created: "2024-05-12T10:24:00Z"
        },
        {
          id: "YC-232",
          pair: ["Mia Clarke", "Lucas Thompson"],
          mutual: ["3D Art"],
          created: "2024-05-12T11:03:00Z"
        },
        {
          id: "YC-233",
          pair: ["Isla Martin", "Oliver Jackson"],
          mutual: ["Animation", "Travel"],
          created: "2024-05-12T11:28:00Z"
        },
        {
          id: "YC-234",
          pair: ["Harper Singh", "Leo Walker"],
          mutual: ["Storytelling"],
          created: "2024-05-12T12:02:00Z"
        }
      ]
    };

    const participantIndex = Object.fromEntries(
      dataset.participants.map((participant) => [participant.name, participant])
    );

    function unique(array) {
      return [...new Set(array)];
    }

    function computeStats() {
      const totalPairs = dataset.matches.length;
      const participantsInMatches = unique(dataset.matches.flatMap(match => match.pair));
      const countries = {};
      const interests = {};
      const hobbies = {};
      dataset.matches.forEach(match => {
        match.mutual.forEach(interest => {
          interests[interest] = (interests[interest] || 0) + 1;
        });
        match.pair.forEach(name => {
          const participant = participantIndex[name];
          if (!participant) return;
          if (participant.country) {
            countries[participant.country] = (countries[participant.country] || 0) + 1;
          }
          (participant.hobbies || []).forEach(hobby => {
            hobbies[hobby] = (hobbies[hobby] || 0) + 1;
          });
        });
      });

      const recentMatch = dataset.matches.at(-1);
      const totalParticipants = dataset.participants.length;
      const activeRate = Math.round((participantsInMatches.length / totalParticipants) * 100);

      return {
        totalPairs,
        totalParticipants,
        participantsInMatches: participantsInMatches.length,
        activeRate,
        latestMatch: recentMatch ? new Date(recentMatch.created) : null,
        countries,
        interests,
        hobbies
      };
    }

    function renderStats(stats) {
      const statCards = document.getElementById('stat-cards');
      const { totalPairs, totalParticipants, participantsInMatches, activeRate, latestMatch } = stats;

      const formatDate = (date) => date ? date.toLocaleString(undefined, { dateStyle: 'medium', timeStyle: 'short' }) : 'N/A';

      const stats = [
        { label: 'Total participants', value: totalParticipants },
        { label: 'Pairs matched', value: totalPairs },
        { label: 'People matched', value: participantsInMatches },
        { label: 'Active match rate', value: `${activeRate}%` },
        { label: 'Last match', value: formatDate(latestMatch) }
      ];

      statCards.innerHTML = stats.map(stat => `
        <div class="stat">
          <div class="value">${stat.value}</div>
          <div class="muted">${stat.label}</div>
        </div>
      `).join('');
    }

    function renderMatchesTable() {
      const body = document.getElementById('matches-table');
      body.innerHTML = dataset.matches
        .slice()
        .sort((a, b) => new Date(b.created) - new Date(a.created))
        .map(match => {
          const [first, second] = match.pair.map(name => participantIndex[name]);
          const participantCell = participant => `
            <div class="person">
              <div class="person-name">${participant?.name ?? 'Unknown'}</div>
              ${participant ? `<div class="muted">Country: ${participant.country}</div>` : ''}
              ${participant && participant.hobbies && participant.hobbies.length ? `
                <div class="person-meta">Hobbies</div>
                <div class="chip-row">
                  ${participant.hobbies.map(hobby => `<span class="chip">${hobby}</span>`).join('')}
                </div>
              ` : ''}
            </div>
          `;
          return `
            <tr>
              <td>
                <div class="match-meta">
                  <strong>${match.id}</strong>
                  <div class="muted">${new Date(match.created).toLocaleString()}</div>
                </div>
              </td>
              <td>${participantCell(first)}</td>
              <td>${participantCell(second)}</td>
              <td>
                <div class="chip-row">
                  ${match.mutual.map(item => `<span class="chip">${item}</span>`).join('')}
                </div>
              </td>
            </tr>
          `;
        })
        .join('');
    }

    function renderBars(values, targetId, unit = 'matches') {
      const max = Math.max(...Object.values(values), 1);
      const entries = Object.entries(values).sort((a, b) => b[1] - a[1]);
      document.getElementById(targetId).innerHTML = entries.map(([key, value]) => `
        <div class="bar">
          <div style="display:flex;justify-content:space-between;align-items:center;font-size:14px">
            <span>${key}</span>
            <span class="muted">${value} ${unit}${value === 1 ? '' : 's'}</span>
          </div>
          <div class="bar-track">
            <div class="bar-fill" style="width:${(value / max) * 100}%"></div>
          </div>
        </div>
      `).join('');
    }

    function renderInterestTable(stats) {
      const { interests } = stats;
      const participantsByInterest = {};
      dataset.matches.forEach(match => {
        match.mutual.forEach(interest => {
          participantsByInterest[interest] = participantsByInterest[interest] || new Set();
          match.pair.forEach(name => participantsByInterest[interest].add(name));
        });
      });

      const body = document.getElementById('interest-table');
      body.innerHTML = Object.entries(interests)
        .sort((a, b) => b[1] - a[1])
        .map(([interest, matches]) => {
          const participants = participantsByInterest[interest] ? participantsByInterest[interest].size : 0;
          return `
            <tr>
              <td>${interest}</td>
              <td>${matches}</td>
              <td>${participants}</td>
            </tr>
          `;
        }).join('');
    }

    function renderAll() {
      const stats = computeStats();
      renderStats(stats);
      renderMatchesTable();
      renderBars(stats.interests, 'interest-bars', 'matches');
      renderBars(stats.countries, 'country-bars', 'participants');
      renderBars(stats.hobbies, 'hobby-bars', 'participants');
      renderInterestTable(stats);
    }

    function unlockDashboard() {
      const input = document.getElementById('admin-pass');
      const error = document.getElementById('lock-error');
      if (input.value.trim() === PASSWORD) {
        document.getElementById('lock-screen').style.display = 'none';
        document.getElementById('dashboard').style.display = 'grid';
        renderAll();
        input.value = '';
        error.textContent = '';
      } else {
        error.textContent = 'Incorrect password. Access denied.';
        input.value = '';
        input.focus();
      }
    }

    document.getElementById('unlock-btn').addEventListener('click', unlockDashboard);
    document.getElementById('admin-pass').addEventListener('keypress', (event) => {
      if (event.key === 'Enter') {
        unlockDashboard();
      }
    });

    document.getElementById('lock-btn').addEventListener('click', () => {
      document.getElementById('dashboard').style.display = 'none';
      document.getElementById('lock-screen').style.display = 'flex';
      const input = document.getElementById('admin-pass');
      input.value = '';
      input.focus();
    });

    document.getElementById('refresh-btn').addEventListener('click', () => {
      renderAll();
      const btn = document.getElementById('refresh-btn');
      btn.textContent = 'Refreshed';
      btn.disabled = true;
      setTimeout(() => {
        btn.textContent = 'Refresh Data';
        btn.disabled = false;
      }, 1600);
    });

    window.addEventListener('load', () => {
      document.getElementById('admin-pass').focus();
    });
  </script>
</body>
</html>
